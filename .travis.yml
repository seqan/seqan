language: cpp
compiler:
  - gcc-4.8
  - clang
cache:
  apt: true
  directories:
  - _build
before_script:
  - sudo apt-get install -qq cmake python python-nose zlib1g-dev libbz2-dev libboost-dev python-jinja2 python-pip
  - sudo pip install -r manual/requirements.txt
  - sudo add-apt-repository -y ppa:ubuntu-toolchain-r/test;
    sudo apt-get update -qq;
    sudo apt-get install -qq gcc-4.8 g++-4.8;
    if [ "$CC" == "gcc" ];
    then
      export CXX=g++-4.8 CC=gcc-4.8;
      gcc-4.8 --version;
    fi
  - if [ "$CXX" == "clang++" ];
    then
        OLDPWD=$(pwd);
        svn co --quiet http://llvm.org/svn/llvm-project/libcxx/trunk libcxx;
        cd libcxx/lib && bash buildit;
        sudo cp ./libc++.so.1.0 /usr/lib/;
        sudo mkdir /usr/include/c++/v1;
        cd .. && sudo cp -r include/* /usr/include/c++/v1/;
        cd /usr/lib && sudo ln -sf libc++.so.1.0 libc++.so;
        sudo ln -sf libc++.so.1.0 libc++.so.1 && cd $cwd;
        cd "$OLDPWD";
    fi
script:
  ./util/travis/linux-cibuild.sh
